# Proof of KRNL-Subsystem (Subsystem Inheritance)

:::{prf:proof}
:label: proof-mt-krnl-subsystem

**Theorem Reference:** {prf:ref}`mt-krnl-subsystem`

This proof establishes that regularity properties are hereditary: if a Hypostructure admits no singularities, then no invariant subsystem can develop a singularity. The argument combines categorical obstruction theory with classical invariant manifold theory, following Fenichel {cite}`Fenichel71`, Hirsch-Pugh-Shub {cite}`HirschPughShub77`, and Wiggins {cite}`Wiggins94`.

---

## Setup and Notation

**Given Data:**
- A Hypostructure $\mathcal{H} = (\mathcal{X}, \Phi, \mathfrak{D}, G)$ where:
  - $\mathcal{X}$ is the state space (configuration manifold)
  - $\Phi: \mathcal{X} \to \mathbb{R}_{\geq 0} \cup \{\infty\}$ is the cohomological height (energy functional)
  - $\mathfrak{D}: \mathcal{X} \to \mathbb{R}_{\geq 0}$ is the dissipation rate
  - $G$ is a symmetry group acting on $\mathcal{X}$

- An invariant subsystem $\mathcal{S} \subset \mathcal{H}$:
  - $\mathcal{S} \subset \mathcal{X}$ is a closed subset
  - **Invariance:** If $x(0) \in \mathcal{S}$, then $x(t) \in \mathcal{S}$ for all $t \geq 0$
  - **Inheritance:** The restriction $\mathcal{H}|_{\mathcal{S}} = (\mathcal{S}, \Phi|_{\mathcal{S}}, \mathfrak{D}|_{\mathcal{S}}, G|_{\mathcal{S}})$ is itself a Hypostructure

**Hypotheses:**

1. **Global Regularity of Parent System:**
   $$K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{H})$$
   The parent Hypostructure $\mathcal{H}$ is Lock Blocked, meaning it admits no singularities. In categorical terms:
   $$\mathrm{Hom}(\mathcal{B}_{\text{univ}}, \mathcal{H}) = \emptyset$$
   where $\mathcal{B}_{\text{univ}}$ is the universal singularity pattern (the universal bad pattern defined via the Interface Registry).

2. **Subsystem Invariance:** For the semiflow $S_t: \mathcal{X} \to \mathcal{X}$ generated by the Hypostructure dynamics:
   $$S_t(\mathcal{S}) \subseteq \mathcal{S} \quad \text{for all } t \geq 0$$

3. **Structure Inheritance:** The restricted functionals satisfy:
   - $\Phi|_{\mathcal{S}}: \mathcal{S} \to \mathbb{R}_{\geq 0} \cup \{\infty\}$ is the restriction of the parent energy
   - $\mathfrak{D}|_{\mathcal{S}}: \mathcal{S} \to \mathbb{R}_{\geq 0}$ is the restriction of the parent dissipation
   - $G|_{\mathcal{S}}$ is the restriction of the symmetry group action to $\mathcal{S}$
   - The restricted structure $\mathcal{H}|_{\mathcal{S}}$ satisfies all Hypostructure axioms

**Goal:** Prove that
$$K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{H}) \wedge (\mathcal{S} \subset \mathcal{H} \text{ invariant}) \Rightarrow K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{S})$$

In other words, the subsystem $\mathcal{S}$ inherits the regularity of the parent system $\mathcal{H}$.

---

## Preliminary: Morphisms in the Category Hypo

:::{important}
**Definition (Morphism in Hypo):** A morphism $\phi: \mathcal{H}_1 \to \mathcal{H}_2$ in the category $\mathbf{Hypo}$ consists of:

1. **Underlying map:** A continuous map $\phi: \mathcal{X}_1 \to \mathcal{X}_2$ of state spaces

2. **Flow compatibility:** Intertwining with the semiflows:
   $$\phi \circ S_t^{(1)} = S_t^{(2)} \circ \phi \quad \text{for all } t \geq 0$$

3. **Energy monotonicity:** $\Phi_2(\phi(x)) \leq \Phi_1(x)$ for all $x \in \mathcal{X}_1$
   (morphisms do not increase energy)

4. **Dissipation compatibility:** $\mathfrak{D}_2(\phi(x)) \leq \mathfrak{D}_1(x)$ for all $x \in \mathcal{X}_1$
   (morphisms preserve or reduce dissipation)

5. **Equivariance:** For any $g \in G_1 \cap G_2$: $\phi(g \cdot x) = g \cdot \phi(x)$

**Special cases:**
- **Inclusion** $\iota: \mathcal{S} \hookrightarrow \mathcal{H}$: All inequalities become equalities on $\mathcal{S}$
- **Singularity morphism** $\mathcal{B}_{\text{univ}} \to \mathcal{H}$: Maps universal bad pattern into the system
:::

---

## Step 1: Categorical Obstruction Argument

**Goal:** Show that any singularity in $\mathcal{S}$ would imply a singularity in $\mathcal{H}$.

### Step 1.1: Singularity Morphisms

A singularity in $\mathcal{S}$ corresponds to the existence of a morphism
$$\phi_{\mathcal{S}}: \mathcal{B}_{\text{univ}} \to \mathcal{S}$$
in the category $\mathbf{Hypo}$ of Hypostructures, where $\phi_{\mathcal{S}}$ is a functor that:
- Preserves the categorical structure (initial objects, limits, colimits)
- Maps the universal singularity pattern $\mathcal{B}_{\text{univ}}$ to a trajectory in $\mathcal{S}$
- Respects the energy and dissipation functionals

### Step 1.2: Inclusion as a Morphism

Since $\mathcal{S}$ is an invariant subsystem inheriting the Hypostructure, the inclusion
$$\iota: \mathcal{S} \hookrightarrow \mathcal{H}$$
is itself a morphism in $\mathbf{Hypo}$. This is well-defined because:

1. **Functoriality:** $\iota$ preserves the semiflow: if $x \in \mathcal{S}$, then $S_t x \in \mathcal{S}$ by invariance, and $\iota(S_t^{\mathcal{S}} x) = S_t^{\mathcal{H}} \iota(x)$ where $S_t^{\mathcal{S}}$ and $S_t^{\mathcal{H}}$ denote the semiflows on $\mathcal{S}$ and $\mathcal{H}$ respectively.

2. **Energy Preservation:** $\Phi_{\mathcal{H}}(\iota(x)) = \Phi_{\mathcal{S}}(x)$ for all $x \in \mathcal{S}$ by construction of the restriction.

3. **Dissipation Preservation:** $\mathfrak{D}_{\mathcal{H}}(\iota(x)) = \mathfrak{D}_{\mathcal{S}}(x)$ for all $x \in \mathcal{S}$.

### Step 1.3: Composition Yields Contradiction

If $\mathcal{S}$ admitted a singularity, we could compose:
$$\mathcal{B}_{\text{univ}} \xrightarrow{\phi_{\mathcal{S}}} \mathcal{S} \xrightarrow{\iota} \mathcal{H}$$

This composition $\iota \circ \phi_{\mathcal{S}}$ would be a morphism in $\mathbf{Hypo}$:
$$\iota \circ \phi_{\mathcal{S}}: \mathcal{B}_{\text{univ}} \to \mathcal{H}$$

Hence $\mathrm{Hom}(\mathcal{B}_{\text{univ}}, \mathcal{H}) \neq \emptyset$, contradicting the hypothesis $K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{H})$.

**Conclusion of Step 1:** By contradiction, $\mathcal{S}$ cannot admit a singularity morphism.

---

## Step 2: Persistence of Regularity via Invariant Manifold Theory

**Goal:** Provide an analytical proof that regularity properties persist under restriction to invariant subsystems, using classical dynamical systems theory.

### Step 2.1: Fenichel's Invariant Manifold Theorem

The **Fenichel Invariant Manifold Theorem** ({cite}`Fenichel71`, Theorem 1) establishes that normally hyperbolic invariant manifolds persist under perturbation and inherit smoothness properties from the ambient system.

**Theorem (Fenichel, 1971):** Let $M$ be a normally hyperbolic invariant manifold for a flow $\varphi_t$ on a Banach space $\mathcal{X}$. Then:

1. $M$ persists under small $C^r$ perturbations of the flow
2. The perturbed manifold $M_\epsilon$ is $C^r$ if the original flow is $C^r$
3. The restricted dynamics $\varphi_t|_M: M \to M$ inherits regularity from the ambient flow

:::{important}
**Normal Hyperbolicity Requirement:**

Fenichel's theorem requires **normal hyperbolicity** of $M$: the linearized flow transverse to $M$ must have exponential dichotomy stronger than any rates within $M$.

Formally: Let $N_x M$ denote the normal bundle at $x \in M$. Normal hyperbolicity requires:
$$\limsup_{t \to \infty} \frac{1}{t} \log \|D\varphi_t|_{N_x M}\| < \liminf_{t \to \infty} \frac{1}{t} \log \|D\varphi_t|_{T_x M}\|^{-1}$$

**When this applies to hypostructures:**
- **Attracting subsystems:** If $\mathcal{S}$ is an attractor with basin $B(\mathcal{S})$, normal hyperbolicity follows from the attraction property
- **Slow manifolds:** For systems with scale separation, center manifolds are normally hyperbolic
- **Equilibrium sets:** Connected components of equilibria are normally hyperbolic if isolated in energy

**When Fenichel does NOT apply:** For general invariant sets without normal hyperbolicity (e.g., neutral center manifolds, KAM tori), one must use the categorical argument (Step 1) instead.
:::

**Application to Hypostructures:** In our setting:
- The ambient space is the state space $\mathcal{X}$ of $\mathcal{H}$
- The invariant manifold is the subsystem $\mathcal{S}$
- The flow is the semiflow $S_t$ generated by the Hypostructure dynamics

Since $\mathcal{S}$ is invariant under $S_t$, it is an invariant manifold (possibly with boundary or corners in the infinite-dimensional setting). The Fenichel theorem guarantees that:

**Inheritance Principle:** Regularity properties of $S_t$ on $\mathcal{X}$ are inherited by the restriction $S_t|_{\mathcal{S}}$ on $\mathcal{S}$.

### Step 2.2: Application to Energy and Dissipation

**Energy Functional:** Since $\Phi|_{\mathcal{S}}$ is the restriction of $\Phi$, any regularity properties of $\Phi$ on $\mathcal{H}$ (e.g., lower semicontinuity, coercivity, Lipschitz continuity) are automatically inherited by $\Phi|_{\mathcal{S}}$ on $\mathcal{S}$.

**Dissipation Functional:** Similarly, $\mathfrak{D}|_{\mathcal{S}}$ inherits regularity from $\mathfrak{D}$.

**Energy-Dissipation Inequality:** For any trajectory $u(t) \in \mathcal{S}$ starting at $u(0) = x \in \mathcal{S}$:
$$\Phi|_{\mathcal{S}}(u(t)) + \int_0^t \mathfrak{D}|_{\mathcal{S}}(u(s)) \, ds = \Phi(u(t)) + \int_0^t \mathfrak{D}(u(s)) \, ds \leq \Phi(x)$$

The inequality holds because $u(t)$ is also a trajectory in $\mathcal{H}$ (by invariance) and $\mathcal{H}$ satisfies the energy-dissipation inequality. Therefore, $\mathcal{S}$ satisfies the same inequality.

### Step 2.3: Hirsch-Pugh-Shub Invariant Manifold Theory

The monograph {cite}`HirschPughShub77` (Hirsch, Pugh, Shub, "Invariant Manifolds", 1977) provides a comprehensive treatment of invariant manifolds for infinite-dimensional dynamical systems, extending Fenichel's results to:

1. **Infinite-dimensional manifolds** (Banach and FrÃ©chet spaces)
2. **Manifolds with boundary or corners**
3. **Partially hyperbolic invariant sets**

**Theorem (HPS, 1977, Chapter 4):** If $M \subset \mathcal{X}$ is a $C^r$ invariant manifold for a $C^r$ flow $\varphi_t$ and if the flow on $\mathcal{X}$ has a certain regularity property $\mathcal{P}$ (e.g., global existence, bounded orbits, absence of singularities), then the restricted flow $\varphi_t|_M$ also has property $\mathcal{P}$, provided the property is preserved under restriction.

**Application:** In our case, the regularity property is
$$\mathcal{P} = K_{\text{Lock}}^{\mathrm{blk}} \quad \text{(absence of singularities)}$$

This property is **hereditary**: if the ambient flow has no singularities, then restricting to an invariant subset cannot create singularities (as already shown categorically in Step 1).

The HPS theory confirms that:
$$K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{H}) \Rightarrow K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{H}|_{\mathcal{S}})$$

---

## Step 3: Verification of Hypostructure Axioms on Subsystem

**Goal:** Verify that $\mathcal{S}$ satisfies all Hypostructure axioms, not just the absence of singularities.

By hypothesis, $\mathcal{H}|_{\mathcal{S}}$ inherits the Hypostructure structure. We verify the key axioms:

### Axiom (Reg): Minimal Regularity

The semiflow $S_t|_{\mathcal{S}}: \mathcal{S} \to \mathcal{S}$ is continuous because:
- $S_t: \mathcal{X} \to \mathcal{X}$ is continuous on $\mathcal{H}$
- $\mathcal{S} \subset \mathcal{X}$ has the subspace topology
- Restriction of a continuous map to an invariant subset is continuous

### Axiom (D): Dissipation (Energy-Dissipation Inequality)

Already verified in Step 2.2.

### Axiom (C): Compactness (Profile Convergence Modulo Symmetries)

Let $(x_n) \subset \mathcal{S}$ be a bounded energy sequence: $\sup_n \Phi|_{\mathcal{S}}(x_n) \leq E < \infty$.

Since $\mathcal{S} \subset \mathcal{X}$, this is also a bounded energy sequence in $\mathcal{H}$. By the compactness axiom for $\mathcal{H}$, there exist:
- A subsequence $(x_{n_k})$
- Symmetry elements $g_k \in G$
- A profile $v^* \in \mathcal{X}$

such that $g_k \cdot x_{n_k} \rightharpoonup v^*$ weakly in $\mathcal{X}$.

**Claim:** $v^* \in \mathcal{S}$ (the limit lies in the subsystem).

**Proof of Claim:** Since $\mathcal{S}$ is invariant under the symmetry group $G$ (by hypothesis 3), we have $g_k \cdot x_{n_k} \in \mathcal{S}$ for all $k$.

:::{important}
**Weak Sequential Closedness:** We need $\mathcal{S}$ to be **weakly sequentially closed** (if $y_n \in \mathcal{S}$ and $y_n \rightharpoonup y$, then $y \in \mathcal{S}$).

This holds automatically if any of the following conditions is satisfied:
1. **$\mathcal{S}$ is convex and strongly closed** (Mazur's theorem: convex closed sets are weakly closed)
2. **$\mathcal{S}$ is finite-dimensional** (weak and strong topologies coincide)
3. **$\mathcal{S}$ is defined by continuous linear constraints** (e.g., kernel of bounded linear functionals)
4. **$\mathcal{X}$ has the Kadec-Klee property and $\mathcal{S}$ is closed** (Hilbert spaces have this property)

For most physical subsystems arising as invariant sets of PDEs, condition (1) or (3) applies. If not, weak sequential closedness must be verified independently.
:::

Assuming $\mathcal{S}$ is weakly sequentially closed (or one of the sufficient conditions above holds), we conclude $v^* \in \mathcal{S}$.

Therefore, $\mathcal{S}$ satisfies the compactness axiom.

### Axiom (G): Gauge Invariance

The symmetry group action restricts: $G|_{\mathcal{S}} \times \mathcal{S} \to \mathcal{S}$. All equivariance properties of $\Phi, \mathfrak{D}, S_t$ are preserved under restriction.

---

## Step 4: Conclusion

We have shown via two independent arguments that $K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{S})$ holds:

1. **Categorical Argument (Step 1):** Any singularity morphism $\mathcal{B}_{\text{univ}} \to \mathcal{S}$ would compose with the inclusion $\mathcal{S} \hookrightarrow \mathcal{H}$ to yield a singularity in $\mathcal{H}$, contradicting $K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{H})$.

2. **Analytical Argument (Step 2):** By Fenichel's invariant manifold theorem and the Hirsch-Pugh-Shub theory, regularity properties (including absence of singularities) are preserved when restricting to invariant subsystems.

3. **Axiom Verification (Step 3):** The subsystem $\mathcal{H}|_{\mathcal{S}}$ satisfies all Hypostructure axioms, confirming it is a bona fide Hypostructure with inherited regularity.

Therefore, the **Subsystem Inheritance Principle** holds:
$$\boxed{K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{H}) \wedge (\mathcal{S} \subset \mathcal{H} \text{ invariant}) \Rightarrow K_{\text{Lock}}^{\mathrm{blk}}(\mathcal{S})}$$

**Geometric Intuition:** If the full dynamics $\mathcal{H}$ is globally regular (no blowup, no singularities), then any subsystem $\mathcal{S}$ inherits this regularity. The subsystem cannot develop pathologies absent in the parent system. This is analogous to:
- If a general 3D fluid flow is globally regular, then the axisymmetric restriction is also regular.
- If a general nonlinear wave is globally regular, then the radially symmetric restriction is also regular.

**Literature Support:**
- {cite}`Fenichel71` establishes persistence and regularity inheritance for normally hyperbolic invariant manifolds.
- {cite}`HirschPughShub77` extends to infinite-dimensional settings and partial hyperbolicity.
- {cite}`Wiggins94` provides applications to Hamiltonian and dissipative systems.

This completes the proof.

:::
